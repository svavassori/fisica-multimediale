package ui;import util.*;import numeric.*;import java.awt.*;/** * A canvas displaying an X-Y graph * @author Pasquale Foggia * @version 0.99, Dec 1997 */public class GraphicDisplay extends Canvas  { String xlab, ylab;    double x1, y1, x2, y2;    double x[], y[];    int n;    static final int tickWidth=4;    Insets ins;    CoordinateMapper map;    AxesDrawer axesDrawer;    StatusDisplayer status=null;        public GraphicDisplay()      {         this(new double[0], "", new double[0], "");      }    public GraphicDisplay(double x[], String xlab, double y[], String ylab)      { setBackground(Color.white);        map=new CoordinateMapper();        axesDrawer=new AxesDrawer(map);        setData(x, xlab, y, ylab);      }    public void setStatusDisplayer(StatusDisplayer status)      { this.status=status;      }    public void setIsometric(boolean iso)      { map.setIsometric(iso);        repaint();      }    public void setData(double x[], String xlab, double y[], String ylab)      { this.xlab=xlab;        this.ylab=ylab;        n=x.length;        this.x=new double[n];        this.y=new double[n];        int i;        for(i=0; i<n; i++)          { this.x[i]=x[i];            this.y[i]=y[i];          }        if (n>0)          { x1=x2=x[0];            y1=y2=y[0];          }        else          x1=x2=y1=y2=0;        for(i=1; i<n; i++)          { if (x[i]<x1)              x1=x[i];            else if (x[i]>x2)              x2=x[i];            if (y[i]<y1)              y1=y[i];            else if (y[i]>y2)              y2=y[i];          }        x1-=0.1;        y1-=0.1;        x2+=0.1;        y2+=0.1;        x1 -= 5e-3*Math.abs(x1);        y1 -= 5e-3*Math.abs(y1);        x2 += 5e-3*Math.abs(x2);        y2 += 5e-3*Math.abs(y2);        map.set(x1,y1,x2,y2);        repaint();      }    public void paint(Graphics g)      { super.paint(g);        Dimension d=size();        FontMetrics fm=getFontMetrics(getFont());        if (ins==null)          { ins=new Insets(0, 0, 0, 0);            ins.left=tickWidth+8+fm.stringWidth("9999.9999E99");            ins.top=fm.getHeight()+8;            ins.bottom=2*fm.getHeight()+tickWidth+15;            ins.right=10;          }        map.set(d, ins);        paintAxes(g);        g.setColor(Color.blue);        g.drawString(ylab, 5, fm.getAscent()+2);        g.drawString(xlab,                     d.width-ins.right/2-fm.stringWidth(xlab),                     d.height-fm.getHeight());        g.setColor(Color.red);        if (n<1)          return;        Point pt0=realToPixel(x[0], y[0]);        int i;        for(i=1; i<n; i++)          { Point pt=realToPixel(x[i], y[i]);            g.drawLine(pt0.x, pt0.y, pt.x, pt.y);            pt0=pt;          }      }    void paintAxes(Graphics g)      { Dimension d=size();        FontMetrics fm=getFontMetrics(getFont());        g.setColor(Color.blue);        g.drawRect(ins.left, ins.top,                    d.width-ins.left-ins.right,                   d.height-ins.bottom-ins.top) ;        axesDrawer.drawAxes(g, new Point(ins.left, d.height-ins.bottom));      }    public boolean mouseMove(Event evt, int x, int y)      { if (status!=null)          { double r[]={0, 0};            pixelToReal(x,y,r);            String msg;            if (r[0]>=x1 && r[0]<=x2 && r[1]>=y1 && r[1]<=y2)              msg=xlab+":"+Format.remove(r[0], (x2-x1)/1000)+                       "  "+ylab+":"+Format.remove(r[1], (y2-y1)/1000);            else              msg="";            status.showStatus(msg);          }        return super.mouseMove(evt, x, y);      }    public boolean mouseExit(Event evt, int x, int y)      { if (status!=null)          status.showStatus("");        return super.mouseMove(evt, x, y);      }    Point realToPixel(double x, double y)      {         return map.realToPixel(x, y);      }    void pixelToReal(int x, int y, double z[])      { map.pixelToReal(x, y, z);      }  }