package fismod;import java.io.*;import ui.*;import java.awt.*;import util.Preloader;public class FisModFrame extends TrackedFrame implements StatusDisplayer  { ImageLoader il;    HelpDisplayer help;    Parameters parm;    Exit exit;    Label info_text;    Panel cardsPanel;    CardLayout cards;    SimulationDisplay simulationDisplay;    SimulationBohr    simulationBohr;    SimulationSpettro simulationSpettro;    SimulationCompton simulationCompton;	public FisModFrame() {        super("Fisica moderna");    }    public void go(Parameters parm, Exit exit)	{ //super("Fisica moderna");        il=UserInterface.getImageLoader();        help=UserInterface.getHelpDisplayer();        this.parm=parm;        this.exit=exit;        setIconImage(il.load("icons/simul.gif"));        if (!WindowsTracker.isEnabled())            createMenuBar();        createPanel();        createStatus();        createToolbar();        centerOnScreen();      }    void createMenuBar()      { Font font=new Font("Helvetica", Font.PLAIN, 12);        MenuBar mb=new MenuBar();        Menu m=new Menu("Esperimento");        m.add("Atomo di Bohr");        m.add("Spettro atomico dell'idrogeno...");        m.add("Effetto Compton...");        m.addSeparator();        m.add("Uscita...");        m.setFont(font);        mb.add(m);        m=new Menu("Aiuto");        m.add("Aiuto");        mb.add(m);        mb.setFont(font);        //setMenuBar(mb);      }    void createToolbar() {         Toolbar tb=new Toolbar(Toolbar.VERTICAL);        String tipo=parm.getString("tipo", "null");        show("*Blank*");        if ("bohr".equals(tipo)) {            tb.addTool("Atomo di Bohr", il.load("icons/atomo.gif"),                    "Atomo di Bohr");            show("Bohr");        } else if ("compton".equals(tipo)) {            tb.addTool("Effetto Compton...", il.load("icons/compton.gif"),                    "Effetto Compton");            show("Compton");        } else if ("spettro".equals(tipo)) {            tb.addTool("Spettro atomico dell'idrogeno...",                     il.load("icons/spettro.gif"),                    "Spettro atomico dell'idrogeno");            show("Spettro");        } else {            tb.addTool("Atomo di Bohr", il.load("icons/atomo.gif"),                    "Atomo di Bohr");            tb.addTool("Spettro atomico dell'idrogeno...",                     il.load("icons/spettro.gif"),                    "Spettro atomico dell'idrogeno");            tb.addTool("Effetto Compton...", il.load("icons/compton.gif"),                    "Effetto Compton");        }                /*tb.addTool("Atomo di Bohr", il.load("icons/atomo.gif"),                   "Atomo di Bohr");        tb.addTool("Spettro atomico dell'idrogeno...",                     il.load("icons/spettro.gif"),                   "Spettro atomico dell'idrogeno");        tb.addTool("Effetto Compton...", il.load("icons/compton.gif"),                   "Effetto Compton");*/        tb.addTool("Uscita...", il.load("icons/exit.gif"),                   "Esci dal programma");        tb.setStatusDisplayer(this);        add("West", tb);      }    void createPanel()      { cardsPanel=new Panel();        cards=new CardLayout();        cardsPanel.setLayout(cards);        simulationBohr=new SimulationBohr();        cardsPanel.add("Bohr", simulationBohr);        simulationSpettro=new SimulationSpettro();        cardsPanel.add("Spettro", simulationSpettro);        simulationCompton=new SimulationCompton();        cardsPanel.add("Compton", simulationCompton);                cardsPanel.add("ExitPanel", new ExitPanel("*Exit*","*CancelExit*"));        // To be continued        add("Center", cardsPanel);        simulationDisplay=simulationBohr;        Panel blank=new Panel();        blank.setBackground(Color.white);        cardsPanel.add("*Blank*", blank);      }    public void show(String name)      { cards.show(cardsPanel, name);        cardsPanel.repaint();        if (name.equals("Bohr"))            simulationDisplay=simulationBohr;        else if (name.equals("Compton"))            simulationDisplay=simulationCompton;        else if (name.equals("Spettro"))            simulationDisplay=simulationSpettro;      }    public void createStatus()      { Font font=new Font("Helvetica", Font.PLAIN, 12);        info_text=new Label("");        info_text.setBackground(Color.lightGray);        info_text.setAlignment(Label.CENTER);        info_text.setFont(font);        add("South", info_text);      }        public void showStatus(String status)      { info_text.setText(status);      }    synchronized public boolean action(Event evt, Object what)      {         if ("Uscita...".equals(what))            show("ExitPanel");        else if ("*CancelExit*".equals(what)) {            if (simulationDisplay==simulationSpettro)                 show("Spettro");            else if (simulationDisplay==simulationBohr)                show("Bohr");            else if (simulationDisplay==simulationCompton)                show("Compton");        }        else if ("*Exit*".equals(what))          { simulationDisplay.stopAnimation();            //salva su file C://Simul il numero 1            salva();            if (simulationDisplay==simulationSpettro)                 show("Spettro");            else if (simulationDisplay==simulationBohr)                show("Bohr");            else if (simulationDisplay==simulationCompton)                show("Compton");            exit.exit(this, null);          }        else if ("Atomo di Bohr".equals(what))          { simulationDisplay.stopAnimation();            show("Bohr");            simulationDisplay=simulationBohr;            simulationDisplay.startAnimation();            toFront();          }        else if ("Spettro atomico dell'idrogeno...".equals(what))          { simulationDisplay.stopAnimation();            show("Spettro");            simulationDisplay=simulationSpettro;            simulationDisplay.startAnimation();            toFront();          }        else if ("Effetto Compton...".equals(what))          { simulationDisplay.stopAnimation();            show("Compton");            simulationDisplay=simulationCompton;            simulationDisplay.startAnimation();            toFront();          }        else if ("Aiuto".equals(what))          help.displayHelp("help/fismod", "fismod");                return true;      }    synchronized public boolean handleEvent(Event evt) { 		if (evt.id==Event.WINDOW_DESTROY)                      show("ExitPanel");        return super.handleEvent(evt);    }    public void salva()  {        if (Preloader.isPreloadActive()) {		    try {		            Writer out = new FileWriter(Preloader.getSimulFileName());				out.write("1");				out.flush();				out.close(); 			} 		    catch(Exception e) {     			  System.out.println("File non trovato");     		}		}    }  }