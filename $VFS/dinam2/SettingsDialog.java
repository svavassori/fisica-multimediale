package dinam2;import ui.*;import java.awt.*;import dinam2.*;/** * A dialog box to input new settings */public class SettingsDialog extends TrackedDialog  {     Component target;    Settings initial;    HelpDisplayer help;    static Font font_small=new Font("TimesRoman", Font.PLAIN, 12);    static Font font_medium=new Font("TimesRoman", Font.PLAIN, 14);    static Font font_large=new Font("TimesRoman", Font.BOLD, 16);    TabsPanel tabs;    CheckboxGroup cbg;    Checkbox cb[];    Checkbox cbP[];    NumericInput massa;    NumericInput elast, res_lam, res_turb;    NewVectorInput forza;    CheckboxGroup cbgP;    Panel cards_panel;    CardLayout cards;    /**     * Create a new settings dialog. If the user confirms     * the changes, the target component will be notified with     * an action event having a Settings object as the argument     */    public SettingsDialog(Component target, Settings initial)      { super(UserInterface.getDummyFrame(),               "Impostazione dei parametri", true);        this.target=target;        this.initial=initial;        help=UserInterface.getHelpDisplayer();        // setLayout(new VerticalLayout(VerticalLayout.JUSTIFIED));        setLayout(new BorderLayout());                //        // Crea la barra di bottoni in alto        //        tabs=new TabsPanel();        tabs.setFont(font_small);        tabs.add("Tipo di campo");        tabs.add("Campo elastico");        tabs.add("Forza costante");        tabs.add("Campo gravitazionale");        add("North", tabs);        cards_panel=new Panel();        cards=new CardLayout();        cards_panel.setLayout(cards);        Label lab;        //        // Crea il pannello con l'input del tipo di campo        //        Panel tipo_panel=new Panel();        tipo_panel.setLayout(new VerticalLayout(VerticalLayout.LEFT));        lab=new Label("Tipo di campo");        lab.setFont(font_large);        tipo_panel.add("", lab);        cbg=new CheckboxGroup();        cb=new Checkbox[Settings.TIPI_DI_CAMPO];        cb[Settings.ELASTICO]=new Checkbox("Campo elastico", cbg, false);        tipo_panel.add("", cb[Settings.ELASTICO]);                cb[Settings.GRAVITAZIONALE]=                      new Checkbox("Campo gravitazionale", cbg, false);        tipo_panel.add("", cb[Settings.GRAVITAZIONALE]);        int i;        for(i=0; i<Settings.TIPI_DI_CAMPO; i++)          cb[i].setFont(font_medium);                cards_panel.add("Tipo", tipo_panel);                       //        // Crea il pannello con l'input per il campo elastico        //        Panel elast_panel=new Panel();        elast_panel.setLayout(new VerticalLayout(VerticalLayout.JUSTIFIED));        lab=new Label("Campo elastico");        lab.setFont(font_large);        elast_panel.add("", lab);        lab=new Label("Costante elastica [N/m]");        lab.setFont(font_medium);        elast_panel.add("", lab);        elast=new NumericInput(1, 800, 1, 0.05);        elast.setValue(initial.costante_elastica);        elast_panel.add("", elast);        lab=new Label("Resistenza in regime laminare [N*s/m]");        lab.setFont(font_medium);        elast_panel.add("", lab);        res_lam=new NumericInput(0, 400, 0, 0.01);        res_lam.setValue(initial.resistenza_laminare);        elast_panel.add("", res_lam);        lab=new Label("Resistenza in regime turbolento [N*s^2/m^2]");        lab.setFont(font_medium);        elast_panel.add("", lab);        res_turb=new NumericInput(0,400, 0, 0.01);        res_turb.setValue(initial.resistenza_turbolenta);        elast_panel.add("", res_turb);        cards_panel.add("Elastico", elast_panel);        // Pannello con l'input della forza costante        Panel forza_panel=new Panel();        forza_panel.setLayout(new VerticalLayout(VerticalLayout.JUSTIFIED));        lab=new Label("Forza costante [N]");        lab.setFont(font_large);        forza_panel.add("", lab);        forza=new NewVectorInput(-40, 40, -40, 40, 1000);        forza.setValue(initial.fx, initial.fy);        forza_panel.add("", forza);        cards_panel.add("Forza", forza_panel);                // Pannello con gli input del campo gravitazionale        Panel grav_panel=new Panel();        cbgP=new CheckboxGroup();        cbP=new Checkbox[Settings.Pianeti];        grav_panel.setLayout(new VerticalLayout(VerticalLayout.LEFT));        lab=new Label("Campo gravitazionale");        lab.setFont(font_large);        grav_panel.add("", lab);        lab=new Label("Massa [10^24 Kg]");        lab.setFont(font_medium);        grav_panel.add("", lab);        massa=new NumericInput(10,200000, 200, 0.01);        //massa.setValue(initial.massa/1e24);        grav_panel.add("", massa);        grav_panel.setLayout(new FlowLayout(FlowLayout.LEFT));                cbP[Settings.iMassaScelta]=new    Checkbox("Massa a Scelta",cbgP,true);        grav_panel.add("", cbP[Settings.iMassaScelta]);                cbP[Settings.iMassaTerrestre]=new Checkbox("Massa Terra   ",cbgP,false);        grav_panel.add("", cbP[Settings.iMassaTerrestre]);                cbP[Settings.iMassaMercurio]=new  Checkbox("Massa Mercurio",cbgP,false);        grav_panel.add("", cbP[Settings.iMassaMercurio]);        cbP[Settings.iMassaVenere]=new    Checkbox("Massa Venere  ",cbgP,false);        grav_panel.add("", cbP[Settings.iMassaVenere]);        cbP[Settings.iMassaMarte]=new     Checkbox("Massa Marte   ",cbgP,false);        grav_panel.add("", cbP[Settings.iMassaMarte]);        cbP[Settings.iMassaGiove]=new     Checkbox("Massa Giove   ",cbgP,false);        grav_panel.add("", cbP[Settings.iMassaGiove]);              cbP[Settings.iMassaSaturno]=new   Checkbox("Massa Saturno ",cbgP,false);        grav_panel.add("", cbP[Settings.iMassaSaturno]);        cbP[Settings.iMassaUrano]=new     Checkbox("Massa Urano   ",cbgP,false);        grav_panel.add("", cbP[Settings.iMassaUrano]);        cbP[Settings.iMassaNettuno]=new   Checkbox("Massa Nettuno ",cbgP,false);        grav_panel.add("", cbP[Settings.iMassaNettuno]);        cbP[Settings.iMassaPlutone]=new   Checkbox("Massa Plutone ",cbgP,false);        grav_panel.add("", cbP[Settings.iMassaPlutone]);        int ki;        for(ki=0; i<Settings.Pianeti; i++)          cbP[ki].setFont(font_medium);                cards_panel.add("Gravitazionale", grav_panel);                add("Center", cards_panel);        cards.show(cards_panel, "Tipo");        //        // Crea la barra di bottoni in basso        //        ImageLoader il=UserInterface.getImageLoader();        Panel confirm_panel=new Panel();        confirm_panel.setFont(font_large);        confirm_panel.setLayout(new FlowLayout(FlowLayout.LEFT));        confirm_panel.add("", new ImageButton3D("OK",                                   il.load("icons/ok.gif")));        confirm_panel.add("", new ImageButton3D("Annulla",                                   il.load("icons/cancel.gif")));        confirm_panel.add("", new ImageButton3D("Aiuto",                                   il.load("icons/help.gif")));        // add("", confirm_panel);        add("South", confirm_panel);        cbg.setCurrent(cb[initial.campo]);      }    public boolean action(Event evt, Object what)      { if ("OK".equals(what))          { dispose();            Settings settings=new Settings();            Checkbox curr=cbg.getCurrent();            int i;            for(i=0; i<Settings.TIPI_DI_CAMPO; i++)              if (curr==cb[i])                settings.campo=i;            settings.costante_elastica=elast.getValue();            settings.resistenza_laminare=res_lam.getValue();            settings.resistenza_turbolenta=res_turb.getValue();            settings.fx=forza.getX();            settings.fy=forza.getY();            settings.massa=massa.getValue()*1e24;            target.deliverEvent(new Event(target, Event.ACTION_EVENT, settings));          }        else if ("Annulla".equals(what))          { dispose();          }        else if ("Aiuto".equals(what))          { help.displayHelp("help/dinam2", "param");          }        else if ("Tipo di campo".equals(what))          { cards.show(cards_panel, "Tipo");            tabs.show("Tipo di campo");             validate();          }        else if ("Campo elastico".equals(what) &&                 cbg.getCurrent()==cb[Settings.ELASTICO])          { cards.show(cards_panel, "Elastico");            tabs.show("Campo elastico");            resize(550, 460);             validate();            // pack(); // For a Netscape bug          }        else if ("Forza costante".equals(what) &&                 cbg.getCurrent()==cb[Settings.ELASTICO])          { cards.show(cards_panel, "Forza");            tabs.show("Forza costante");            resize(550, 460);             validate();            // pack(); // For a Netscape bug          }        else if ("Campo gravitazionale".equals(what) &&                 cbg.getCurrent()==cb[Settings.GRAVITAZIONALE])          { cards.show(cards_panel, "Gravitazionale");            tabs.show("Campo gravitazionale");             validate();          }        else {                int i;                if (evt.target==cbP[0]){massa.enable(true);}                else{                for(i=1;i<Settings.Pianeti;i++)                     if (evt.target==cbP[i])                     {                      massa.setValue(Settings.MassaPianeti[i]/1e24);                      massa.enable(false);                      //System.out.println("Aio:"+Settings.MassaPianeti[i]/1e24+"-"+massa.getValue());                     }                    }              }        return true;      }    public boolean handleEvent(Event evt)      { if (evt.id == Event.WINDOW_DESTROY)          dispose();               else if (evt.target==res_lam){                                             if (res_lam.getValue()!=0){res_turb.setValue(0);}                                            }               else if (evt.target==res_turb){                                             if (res_turb.getValue()!=0){res_lam.setValue(0);}                                              }                       return super.handleEvent(evt);      }  }