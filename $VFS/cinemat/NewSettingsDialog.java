package cinemat;import ui.*;import util.*;import java.awt.*;/** * A dialog box to input new settings */public class SettingsDialog extends TrackedDialog  {     Component target;    Settings initial;    HelpDisplayer help;    static Font font_small=new Font("TimesRoman", Font.PLAIN, 12);    static Font font_medium=new Font("TimesRoman", Font.PLAIN, 14);    static Font font_large=new Font("TimesRoman", Font.BOLD, 16);    TabsPanel tabs;    CheckboxGroup cbg_base, cbg_rel, cbg_std;        Checkbox cb_base[], cb_rel[], cb_std[];    NumericInput vel_base, acc_base;    NumericInput vel_ang_base, raggio;    VectorInput vel_rel;    NumericInput vel_rel_ang;    NumericInput x0;    Panel cards_panel;    CardLayout cards;    /**     * Create a new settings dialog. If the user confirms     * the changes, the target component will be notified with     * an action event having a Settings object as the argument     */    public SettingsDialog(Component target, Settings initial)      { super(UserInterface.getDummyFrame(),               "Impostazione dei parametri", true);        this.target=target;        this.initial=initial;        help=UserInterface.getHelpDisplayer();        // setLayout(new VerticalLayout(VerticalLayout.JUSTIFIED));        setLayout(new BorderLayout());        //        // Crea la barra di bottoni in alto        //        tabs=new TabsPanel();        tabs.setFont(font_small);        tabs.add("Tipo di moto");        tabs.add("Moto relativo");        tabs.add("Moto di trascinamento traslatorio");        tabs.add("Moto di trascinamento rotatorio");        add("North", tabs);        cards_panel=new Panel();        cards=new CardLayout();        cards_panel.setLayout(cards);        Label lab;        //        // Crea il pannello con l'input del tipo di moto        //        Panel tipo_panel=new Panel();        tipo_panel.setLayout(new VerticalLayout(VerticalLayout.LEFT));        // Moti Standard        lab=new Label("Moti Standard");        lab.setFont(font_large);        tipo_panel.add("", lab);        cbg_std=new CheckboxGroup();        cb_std=new Checkbox[Settings.TIPI_DI_MOTO_BASE];        cb_std[Settings.UNIFORME]=             new Checkbox("Uniforme", cbg_std, false);        tipo_panel.add("", cb_std[Settings.UNIFORME]);        cb_std[Settings.UNIFACC]=                      new Checkbox("Unif. Accelerato", cbg_std, false);        tipo_panel.add("", cb_std[Settings.UNIFACC]);        cb_std[Settings.SCELTA]=                      new Checkbox("Moti Generali", cbg_std, false);        tipo_panel.add("", cb_std[Settings.ROTATORIO]);        int i;        for(i=0; i<Settings.TIPI_DI_MOTO_BASE; i++)          cb_base[i].setFont(font_medium);        // Moto relativo        lab=new Label("Moto relativo");        lab.setFont(font_large);        tipo_panel.add("", lab);        cbg_base=new CheckboxGroup();        cb_base=new Checkbox[Settings.TIPI_DI_MOTO_BASE];        cb_base[Settings.TRASLATORIO]=             new Checkbox("Traslatorio", cbg_base, false);        tipo_panel.add("", cb_base[Settings.TRASLATORIO]);        cb_base[Settings.ROTATORIO]=                      new Checkbox("Rotatorio", cbg_base, false);        tipo_panel.add("", cb_base[Settings.ROTATORIO]);        int i;        for(i=0; i<Settings.TIPI_DI_MOTO_BASE; i++)          cb_base[i].setFont(font_medium);                // Moto trascinamento        lab=new Label("Moto di trascinamento");        lab.setFont(font_large);        tipo_panel.add("", lab);        cbg_rel=new CheckboxGroup();        cb_rel=new Checkbox[Settings.TIPI_DI_MOTO_RELATIVO];        cb_rel[Settings.NESSUNO]=             new Checkbox("Nessuno", cbg_rel, false);        tipo_panel.add("", cb_rel[Settings.NESSUNO]);        cb_rel[Settings.TRASLATORIO]=             new Checkbox("Traslatorio", cbg_rel, false);        tipo_panel.add("", cb_rel[Settings.TRASLATORIO]);        cb_rel[Settings.ROTATORIO]=                      new Checkbox("Rotatorio", cbg_rel, false);        tipo_panel.add("", cb_rel[Settings.ROTATORIO]);        for(i=0; i<Settings.TIPI_DI_MOTO_RELATIVO; i++)          cb_rel[i].setFont(font_medium);        cards_panel.add("Tipo", tipo_panel);                   //        // Crea il pannello con l'input per le caratteristiche del base        //        Panel moto_panel=new Panel();        moto_panel.setLayout(new VerticalLayout(VerticalLayout.JUSTIFIED));                lab=new Label("Moto traslatorio: x0 [m]");        lab.setFont(font_medium);        moto_panel.add("", lab);        x0=new NumericInput(-2000, 2000, 0, 0.05);        x0.setValue(initial.x0);        moto_panel.add("", x0);        lab=new Label("Moto traslatorio: velocità iniziale [m/s]");        lab.setFont(font_medium);        moto_panel.add("", lab);        vel_base=new NumericInput(-200, 200, 0, 0.05);        vel_base.setValue(initial.vel_base);        moto_panel.add("", vel_base);        lab=new Label("Moto traslatorio: accelerazione [m/s^2]");        lab.setFont(font_medium);        moto_panel.add("", lab);        acc_base=new NumericInput(-200, 200, 0, 0.025);        acc_base.setValue(initial.acc_base);        moto_panel.add("", acc_base);        lab=new Label("Moto rotatorio: velocità angolare [rad/s]");        lab.setFont(font_medium);        moto_panel.add("", lab);        vel_ang_base=new NumericInput(-200, 200, 0, 0.025);        vel_ang_base.setValue(initial.vel_ang_base);        moto_panel.add("", vel_ang_base);        lab=new Label("Moto rotatorio: raggio [m]");        lab.setFont(font_medium);        moto_panel.add("", lab);        raggio=new NumericInput(1, 100, 1, 0.1);        raggio.setValue(initial.raggio);        moto_panel.add("", raggio);        cards_panel.add("Relativo", moto_panel);        // Pannello con l'input del moto relativo traslatorio        Panel vel_rel_panel=new Panel();        vel_rel_panel.setLayout(new VerticalLayout(VerticalLayout.JUSTIFIED));        lab=new Label("Velocità di trascinamento [m/s]");        lab.setFont(font_large);        vel_rel_panel.add("", lab);        vel_rel=new VectorInput(-20, 20, -20, 20);        vel_rel.setValue(initial.vel_rel_x, initial.vel_rel_y);        vel_rel_panel.add("", vel_rel);        cards_panel.add("RelTran", vel_rel_panel);        //        // Crea il pannello con l'input per le caratteristiche del         // moto relativo rotatorio        //        Panel rel_rot_panel=new Panel();        rel_rot_panel.setLayout(new VerticalLayout(VerticalLayout.JUSTIFIED));        lab=new Label("Moto di trascinamento rotatorio");        lab.setFont(font_large);        rel_rot_panel.add("", lab);        lab=new Label("Velocità angolare [rad/s]");        lab.setFont(font_medium);        rel_rot_panel.add("", lab);        vel_rel_ang=new NumericInput(-200, 200, 0, 0.05);        vel_rel_ang.setValue(initial.vel_rel_ang);        rel_rot_panel.add("", vel_rel_ang);        cards_panel.add("RelRot", rel_rot_panel);        add("Center", cards_panel);        cards.show(cards_panel, "Tipo");        //        // Crea la barra di bottoni in basso        //        ImageLoader il=UserInterface.getImageLoader();        Panel confirm_panel=new Panel();        confirm_panel.setFont(font_large);        confirm_panel.setLayout(new FlowLayout(FlowLayout.LEFT));        confirm_panel.add("", new ImageButton3D("OK",                                   il.load("icons/ok.gif")));        confirm_panel.add("", new ImageButton3D("Annulla",                                   il.load("icons/cancel.gif")));        confirm_panel.add("", new ImageButton3D("Aiuto",                                   il.load("icons/help.gif")));        add("South", confirm_panel);        cbg_base.setCurrent(cb_base[initial.moto_base]);        cbg_rel.setCurrent(cb_rel[initial.moto_relativo]);        checkCheckboxes();      }    synchronized public boolean action(Event evt, Object what)      { if ("OK".equals(what))          { dispose();            Settings settings=new Settings();            Checkbox curr=cbg_base.getCurrent();            int i;            for(i=0; i<Settings.TIPI_DI_MOTO_BASE; i++)              if (curr==cb_base[i])                settings.moto_base=i;            curr=cbg_rel.getCurrent();            for(i=0; i<Settings.TIPI_DI_MOTO_RELATIVO; i++)              if (curr==cb_rel[i])                settings.moto_relativo=i;            settings.vel_base=vel_base.getValue();            settings.acc_base=acc_base.getValue();            settings.vel_ang_base=vel_ang_base.getValue();            settings.raggio=raggio.getValue();            settings.vel_rel_x=vel_rel.getX();            settings.vel_rel_y=vel_rel.getY();            settings.vel_rel_ang=vel_rel_ang.getValue();            settings.x0=x0.getValue();            target.deliverEvent(new Event(target, Event.ACTION_EVENT, settings));          }        else if ("Annulla".equals(what))          { dispose();          }        else if ("Aiuto".equals(what))          { help.displayHelp("help/cinemat", "param");          }        else if ("Tipo di moto".equals(what))          { cards.show(cards_panel, "Tipo");            tabs.show("Tipo di moto");             validate();          }        else if ("Moto relativo".equals(what))          { cards.show(cards_panel, "Relativo");            tabs.show("Moto relativo");            resize(550, 460);            validate();          }        else if ("Moto di trascinamento traslatorio".equals(what) &&                 cbg_rel.getCurrent()==cb_rel[Settings.TRASLATORIO])          { cards.show(cards_panel, "RelTran");            tabs.show("Moto di trascinamento traslatorio");            resize(550, 460);            validate();          }        else if ("Moto di trascinamento rotatorio".equals(what) &&                 cbg_rel.getCurrent()==cb_rel[Settings.ROTATORIO])          { cards.show(cards_panel, "RelRot");            tabs.show("Moto di trascinamento rotatorio");             validate();          }        else if (evt.target instanceof Checkbox)          { checkCheckboxes();          }        return true;      }    synchronized public boolean handleEvent(Event evt)      { if (evt.id == Event.WINDOW_DESTROY)          dispose();        return super.handleEvent(evt);      }    void checkCheckboxes()      { int base=0;        Checkbox curr=cbg_base.getCurrent();        int i;        for(i=0; i<Settings.TIPI_DI_MOTO_BASE; i++)          if (curr==cb_base[i])            base=i;        vel_base.enable(base==Settings.TRASLATORIO);        acc_base.enable(base==Settings.TRASLATORIO);        vel_ang_base.enable(base==Settings.ROTATORIO);        raggio.enable(base==Settings.ROTATORIO);      }  }