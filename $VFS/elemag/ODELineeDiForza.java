package elemag;import numeric.*;/** * Sist. di equazioni differenziali usato per le linee di forza */public class ODELineeDiForza implements ODE  { SimulationDisplay simulation;    boolean backwards=false;    public ODELineeDiForza(SimulationDisplay simulation)      { this.simulation=simulation;      }    public void setBackwards(boolean on)      { backwards=on;      }    public int getDimension()      { return 2;      }    public void derive(double t, double s[], double s1[])      { simulation.computeE(s[0], s[1], s1);        double E=Functions.hypot(s1[0], s1[1]);        if (E>1e-15)          { s1[0]/=E;            s1[1]/=E;          }        if (backwards)          { s1[0]=-s1[0];            s1[1]=-s1[1];          }      }  }